<!doctype html>
<html lang="ro">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Planificare Vizite</title>
  <link rel="stylesheet" href="style.css" />

  <!-- SheetJS (Excel import/export) -->
  <script defer src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script defer src="app.js"></script>
</head>

<body>
  <header class="topbar">
    <div class="brand">
      <div class="logo">PV</div>
      <div>
        <div class="title">Planificare Vizite</div>
        <div class="subtitle">Import Excel â†’ Planificare â†’ Export Excel</div>
      </div>
    </div>

    <div class="top-actions">
      <button class="btn ghost" id="btnReset">Reset date</button>
      <button class="btn" id="btnExport">ğŸ“¤ Export Excel</button>
    </div>
  </header>

  <main class="container">
    <nav class="tabs" role="tablist">
      <button class="tab active" data-tab="tab-clients">ClienÈ›i</button>
      <button class="tab" data-tab="tab-agents">AgenÈ›i & Rute</button>
      <button class="tab" data-tab="tab-activities">ActivitÄƒÈ›i</button>
      <button class="tab" data-tab="tab-plan">Planificare</button>
      <button class="tab" data-tab="tab-reports">Raport</button>
    </nav>

    <!-- ============ CLIENTS ============ -->
    <section id="tab-clients" class="panel active">
      <div class="grid2">
        <div class="card">
          <h2>Import clienÈ›i din Excel</h2>
          <p class="hint">
            Excel-ul poate avea coloane cu nume variate. AplicaÈ›ia cautÄƒ automat: <b>Client/Nume</b> È™i <b>Adresa</b>.
          </p>
          <input type="file" id="fileClients" accept=".xlsx,.xls" />
          <div class="row">
            <label class="inline">
              Sheet:
              <input id="sheetName" placeholder="(gol = primul sheet)" />
            </label>
            <button class="btn" id="btnImportClients">ImportÄƒ</button>
          </div>

          <div class="divider"></div>

          <h3>AdaugÄƒ client manual</h3>
          <div class="form">
            <input id="newClientName" placeholder="Nume client" />
            <input id="newClientAddress" placeholder="AdresÄƒ (opÈ›ional)" />
            <button class="btn" id="btnAddClient">AdaugÄƒ client</button>
          </div>
        </div>

        <div class="card">
          <h2>Lista clienÈ›i</h2>
          <div class="row wrap">
            <input id="clientSearch" placeholder="CautÄƒ client..." />
            <button class="btn ghost" id="btnClearClients">È˜terge toÈ›i clienÈ›ii</button>
          </div>

          <div class="table-wrap">
            <table class="table" id="tblClients">
              <thead>
                <tr>
                  <th>Client</th>
                  <th>AdresÄƒ</th>
                  <th>FrecvenÈ›Äƒ</th>
                  <th>SÄƒpt.</th>
                  <th></th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

          <p class="hint">
            FrecvenÈ›Äƒ: <b>lunar</b> cu sÄƒptÄƒmÃ¢ni Ã®n care are loc vizita (1â€“5). Planificarea se genereazÄƒ pe interval Ã®n tab-ul Planificare.
          </p>
        </div>
      </div>
    </section>

    <!-- ============ AGENTS & ROUTES ============ -->
    <section id="tab-agents" class="panel">
      <div class="grid2">
        <div class="card">
          <h2>AgenÈ›i</h2>
          <div class="form">
            <input id="newAgentName" placeholder="Nume agent" />
            <button class="btn" id="btnAddAgent">AdaugÄƒ agent</button>
          </div>
          <div class="table-wrap">
            <table class="table" id="tblAgents">
              <thead><tr><th>Agent</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <h2>Rute</h2>
          <div class="form">
            <input id="newRouteName" placeholder="Nume rutÄƒ" />
            <select id="newRouteAgent"></select>
            <button class="btn" id="btnAddRoute">AdaugÄƒ rutÄƒ</button>
          </div>
          <div class="table-wrap">
            <table class="table" id="tblRoutes">
              <thead><tr><th>RutÄƒ</th><th>Agent</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
          <p class="hint">PoÈ›i lÄƒsa agentul gol la rutÄƒ dacÄƒ vrei.</p>
        </div>
      </div>
    </section>

    <!-- ============ ACTIVITIES ============ -->
    <section id="tab-activities" class="panel">
      <div class="grid2">
        <div class="card">
          <h2>ListÄƒ activitÄƒÈ›i (configurabilÄƒ)</h2>
          <p class="hint">ActivitÄƒÈ›ile se selecteazÄƒ multiple la vizitÄƒ + existÄƒ cÃ¢mp â€Altcevaâ€.</p>
          <div class="form">
            <input id="newActivityName" placeholder="Ex: comanda" />
            <button class="btn" id="btnAddActivity">AdaugÄƒ activitate</button>
          </div>

          <div class="table-wrap">
            <table class="table" id="tblActivities">
              <thead><tr><th>Activitate</th><th></th></tr></thead>
              <tbody></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <h2>NotiÈ›e</h2>
          <ul class="hint">
            <li>Ãn export, activitÄƒÈ›ile multiple sunt concatenate Ã®ntr-o singurÄƒ celulÄƒ.</li>
            <li>Ziua se calculeazÄƒ automat din datÄƒ (fÄƒrÄƒ diacritice).</li>
            <li>Format export: <b>Zi | Data | Client | Activitate | Detalii | Observatii</b>.</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- ============ PLANNING ============ -->
    <section id="tab-plan" class="panel">
      <div class="card">
        <h2>Interval planificare</h2>
        <div class="row wrap">
          <label class="inline">
            De la:
            <input type="date" id="fromDate" />
          </label>
          <label class="inline">
            PÃ¢nÄƒ la:
            <input type="date" id="toDate" />
          </label>

          <button class="btn" id="btnGenerate">GenereazÄƒ vizite (din frecvenÈ›e)</button>
          <button class="btn ghost" id="btnClearVisits">È˜terge vizitele din interval</button>
        </div>

        <p class="hint">
          Generarea creeazÄƒ vizite Ã®n sÄƒptÄƒmÃ¢nile selectate per client. Apoi le poÈ›i ajusta manual Ã®n tabel (date, agent, rutÄƒ, activitÄƒÈ›i etc.).
        </p>
      </div>

      <div class="card">
        <h2>AdaugÄƒ vizitÄƒ manual</h2>
        <div class="grid3">
          <input type="date" id="visitDate" />
          <select id="visitClient"></select>
          <select id="visitAgent"></select>
          <select id="visitRoute"></select>

          <div class="multibox">
            <div class="label">ActivitÄƒÈ›i (multiple)</div>
            <div id="visitActivities" class="chips"></div>
          </div>

          <input id="visitOtherActivity" placeholder="Altceva (opÈ›ional)" />
          <input id="visitDetails" placeholder="Detalii (opÈ›ional)" />
          <input id="visitObs" placeholder="Observatii (opÈ›ional)" />

          <button class="btn" id="btnAddVisit">AdaugÄƒ vizitÄƒ</button>
        </div>
      </div>

      <div class="card">
        <h2>Vizite Ã®n interval</h2>
        <div class="row wrap">
          <label class="inline">
            Sortare:
            <select id="sortMode">
              <option value="date">Data</option>
              <option value="client">Client</option>
              <option value="agent">Agent</option>
              <option value="route">Ruta</option>
            </select>
          </label>
          <button class="btn ghost" id="btnSort">SorteazÄƒ</button>
        </div>

        <div class="table-wrap">
          <table class="table" id="tblVisits">
            <thead>
              <tr>
                <th>Zi</th>
                <th>Data</th>
                <th>Client</th>
                <th>Agent</th>
                <th>Ruta</th>
                <th>Activitate</th>
                <th>Detalii</th>
                <th>Observatii</th>
                <th></th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

        <p class="hint">
          Ziua este calculatÄƒ automat din Data. PoÈ›i edita celulele direct (click Ã®n cÃ¢mp) È™i se salveazÄƒ automat.
        </p>
      </div>
    </section>

    <!-- ============ REPORTS ============ -->
    <section id="tab-reports" class="panel">
      <div class="grid2">
        <div class="card">
          <h2>Raport (interval)</h2>
          <p class="hint">SeteazÄƒ intervalul din tab-ul Planificare. Raportul se bazeazÄƒ pe vizitele din acel interval.</p>

          <div class="row wrap">
            <button class="btn" id="btnRefreshReport">RecalculeazÄƒ raport</button>
          </div>

          <div class="stats" id="reportStats"></div>
        </div>

        <div class="card">
          <h2>DefiniÈ›ii</h2>
          <ul class="hint">
            <li><b>Nr. vizite</b> = numÄƒrul de rÃ¢nduri (vizite) planificate Ã®n interval.</li>
            <li><b>Nr. clienÈ›i unici</b> = cÃ¢È›i clienÈ›i diferiÈ›i apar Ã®n interval.</li>
            <li>PoÈ›i extinde ulterior cu km/rutare (momentan amÃ¢nat).</li>
          </ul>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <span>âœ”ï¸ Datele se salveazÄƒ local (Ã®n browser). Ideal pentru GitHub Pages.</span>
  </footer>
</body>
</html>
